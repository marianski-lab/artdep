

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MM_Util.plot &mdash; MM Core 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=92fd9be5" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=01f34227"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            MM Core
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">MM_Util</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MM Core</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">MM_Util.plot</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for MM_Util.plot</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">colormaps</span>
<span class="kn">import</span> <span class="nn">copy</span>

<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">NullFormatter</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">FormatStrFormatter</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LinearSegmentedColormap</span><span class="p">,</span> <span class="n">ListedColormap</span>

<span class="kn">from</span> <span class="nn">.utilities</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.mol</span> <span class="kn">import</span> <span class="o">*</span>

<div class="viewcode-block" id="Plot">
<a class="viewcode-back" href="../../MM_Util.html#MM_Util.plot.Plot">[docs]</a>
<span class="k">class</span> <span class="nc">Plot</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class that creates plots from a numpy array.</span>
<span class="sd">    It can make reaction coordinate diagrams, RMSD and RMSF trajectory plots,</span>
<span class="sd">    Free energy plots, Scatter Plots, and SNFG Figures.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span><span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">desc</span><span class="p">:</span><span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">xtick</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ytick</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xrange</span><span class="p">:</span><span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">yrange</span><span class="p">:</span><span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">colors</span><span class="p">:</span><span class="nb">list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">],</span> <span class="n">x_extend</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y_extend</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs a plot object.</span>
<span class="sd">        :param data: (array) a numpy array containing the data to be plotted.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Constructor Attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">desc</span> <span class="o">=</span> <span class="n">desc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xtick</span> <span class="o">=</span> <span class="n">xtick</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ytick</span> <span class="o">=</span> <span class="n">ytick</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xrange</span> <span class="o">=</span> <span class="n">xrange</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yrange</span> <span class="o">=</span> <span class="n">yrange</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colors</span> <span class="o">=</span> <span class="n">colors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_extend</span> <span class="o">=</span> <span class="n">x_extend</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_extend</span> <span class="o">=</span> <span class="n">y_extend</span>

<div class="viewcode-block" id="Plot.cmap">
<a class="viewcode-back" href="../../MM_Util.html#MM_Util.plot.Plot.cmap">[docs]</a>
    <span class="k">def</span> <span class="nf">cmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color_num</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">256</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">map</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;ice&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and processes a colormap with optional offsetting logic.</span>
<span class="sd">        :param color_num: (int) Number of discrete colors.</span>
<span class="sd">        :param offset: (float) Fractional offset to shift the colormap.</span>
<span class="sd">        :param map: (str) Name of the colormap from the colormaps library.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check if the colormap exists in colormaps</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">colormaps</span><span class="p">,</span> <span class="nb">map</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Colormap &#39;</span><span class="si">{</span><span class="nb">map</span><span class="si">}</span><span class="s2">&#39; not found in colormaps library!&quot;</span><span class="p">)</span>

        <span class="c1"># Fetch colormap</span>
        <span class="n">colors_obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">colormaps</span><span class="p">,</span> <span class="nb">map</span><span class="p">)</span>
        <span class="n">color_num</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1"># Ensure the colormap has an array of colors</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">colors_obj</span><span class="p">,</span> <span class="s1">&#39;colors&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The selected colormap &#39;</span><span class="si">{</span><span class="nb">map</span><span class="si">}</span><span class="s2">&#39; does not have a valid &#39;colors&#39; attribute!&quot;</span><span class="p">)</span>

        <span class="n">colormap_colors</span> <span class="o">=</span> <span class="n">colors_obj</span><span class="o">.</span><span class="n">colors</span>

        <span class="c1"># Validating the shape of colormap_colors</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">colormap_colors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected RGB colors in the colormap, but got shape </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">colormap_colors</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

        <span class="c1"># Applying offset manually</span>

        <span class="k">if</span> <span class="n">offset</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">new_colors</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">colormap_colors</span><span class="p">:</span>

                <span class="n">new_color</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">color_elm</span> <span class="ow">in</span> <span class="n">color</span><span class="p">:</span>
                    <span class="n">color_elm</span> <span class="o">-=</span> <span class="n">offset</span>

                    <span class="k">if</span> <span class="n">color_elm</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">color_elm</span> <span class="o">=</span> <span class="mi">1</span>

                    <span class="k">if</span> <span class="n">color_elm</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">color_elm</span> <span class="o">=</span> <span class="mi">0</span>

                    <span class="n">new_color</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">color_elm</span><span class="p">)</span>
                <span class="n">new_colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_color</span><span class="p">)</span>

            <span class="n">colormap_colors</span> <span class="o">=</span> <span class="n">new_colors</span>

        <span class="c1"># Discretize the colormap to the required number of colors</span>
        <span class="n">discrete_colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">colormap_colors</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color_num</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">colormap_colors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">discrete_colors</span><span class="p">]</span></div>


<div class="viewcode-block" id="Plot.trajectory">
<a class="viewcode-back" href="../../MM_Util.html#MM_Util.plot.Plot.trajectory">[docs]</a>
    <span class="k">def</span> <span class="nf">trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">var_name</span> <span class="o">=</span> <span class="s1">&#39;colvar&#39;</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Plots MD trajectory with histogram. Takes in data for CP2K or Gromacs via Mol.</span>
<span class="sd">        :param molecule: (Mol) Class Mol. </span>
<span class="sd">        :param var_name: (list) Name of the collective variable you are plotting on your y-axis.</span>
<span class="sd">        :param col: (int) Index of the column containing your colvar data, in the case that you have multiple.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">time</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">colvar</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="n">col</span><span class="p">]</span>
        
        <span class="n">timestep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">time</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        
        <span class="c1"># CP2K default timestep unit is in fs, Gromacs is in ps:</span>
        
        <span class="k">if</span> <span class="n">mol</span><span class="o">.</span><span class="n">software</span> <span class="o">==</span> <span class="s1">&#39;cp2k&#39;</span><span class="p">:</span>
            <span class="n">time_unit</span> <span class="o">=</span> <span class="s1">&#39;fs&#39;</span>
            
        <span class="k">elif</span> <span class="n">mol</span><span class="o">.</span><span class="n">software</span> <span class="o">==</span> <span class="s1">&#39;gromacs&#39;</span><span class="p">:</span>
            <span class="n">time_unit</span> <span class="o">=</span> <span class="s1">&#39;ps&#39;</span>
            
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width_ratios&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>

        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">colvar</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;time (</span><span class="si">{</span><span class="n">time_unit</span><span class="si">}</span><span class="s2">); stepsize = </span><span class="si">{</span><span class="n">timestep</span><span class="si">}{</span><span class="n">time_unit</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">var_name</span><span class="p">)</span>
        <span class="c1"># ax1.set_title(f&quot;file: {xyz_file}&quot;, fontsize = 10)</span>

        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">colvar</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="s1">&#39;rice&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span> 
        
        <span class="c1"># midpt = int(np.round(len(colvar) / 2))</span>
        <span class="c1"># ax[1].hist(colvar[0:midpt], bins=&#39;rice&#39;, fc=(0, 0, 1, 0.3), orientation=&quot;horizontal&quot;) # First half shown in blue</span>
        <span class="c1"># ax[1].hist(colvar[midpt:-1], bins=&#39;rice&#39;, fc=(0, 0, 1, 0.5), orientation=&quot;horizontal&quot;) # Second half shown in red</span>
        <span class="c1"># ax2.axhline(y=np.average(colvar), color=&#39;b&#39;, linewidth=2)</span>

        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;average = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">colvar</span><span class="p">),</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>

        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;structures&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">fig</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span></div>

        
<div class="viewcode-block" id="Plot.fes">
<a class="viewcode-back" href="../../MM_Util.html#MM_Util.plot.Plot.fes">[docs]</a>
    <span class="k">def</span> <span class="nf">fes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mol</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Plots MD FES. Takes in data for CP2K or Gromacs via Mol.</span>
<span class="sd">        :param mol: (Mol) Class Mol.</span>
<span class="sd">        :param cols: (int) Index of the 2 columns containing your colvar data, in the case that you have more than 2.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">Temp</span> <span class="o">=</span> <span class="mi">300</span> <span class="p">;</span> <span class="n">R</span> <span class="o">=</span> <span class="mf">8.314</span> <span class="c1"># J/K mol</span>

        <span class="n">colvar1</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="n">cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">colvar2</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="n">cols</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

        <span class="n">Hall</span><span class="p">,</span> <span class="n">x_edges</span><span class="p">,</span> <span class="n">y_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram2d</span><span class="p">(</span><span class="n">colvar1</span><span class="p">,</span> <span class="n">colvar2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">72</span><span class="p">)</span>
        <span class="n">Hall</span> <span class="o">=</span> <span class="n">Hall</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Hall</span><span class="p">)</span>
        <span class="n">Hall</span><span class="p">[</span><span class="n">Hall</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="n">Hall</span> <span class="o">=</span> <span class="o">-</span> <span class="n">R</span> <span class="o">*</span> <span class="n">Temp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Hall</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span>

        <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">Hall</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">Hall</span><span class="p">)</span>
        
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>
        
        <span class="c1"># colors = self.colors</span>
        <span class="c1"># cmap = ListedColormap(colors)</span>

        <span class="n">num_levels</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="n">plot</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">x_edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">Hall</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues_r&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">num_levels</span><span class="p">)</span>
        <span class="c1"># plot = ax.contourf(x_edges[:-1], y_edges[:-1], Hall.T, cmap=cmap, zorder=1, levels=num_levels)</span>

        <span class="n">num_ticks</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="n">x_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_edges</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_edges</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">num_ticks</span><span class="p">)</span>
        <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y_edges</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_edges</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">num_ticks</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x_ticks</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">y_ticks</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tick</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">x_ticks</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tick</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">y_ticks</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

        <span class="n">cb_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">cb_ticks</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.78</span><span class="p">)</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tick</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">cb_ticks</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Free energy [kJ]&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

        <span class="c1"># Enable grid that aligns with ticks</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>

        <span class="c1"># Axis labels and title</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;colvar1&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;colvar2&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

        <span class="c1"># fig.tight_layout()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">fig</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span></div>

    
<div class="viewcode-block" id="Plot.puckers_hist">
<a class="viewcode-back" href="../../MM_Util.html#MM_Util.plot.Plot.puckers_hist">[docs]</a>
    <span class="k">def</span> <span class="nf">puckers_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mol_pucker</span><span class="p">,</span> <span class="n">mol_fem</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Plots ring pucker free energy surface. Requires 2 mol objects to run.</span>
<span class="sd">        :param mol_pucker: (Mol) Class Mol containing the .xvg file for your ring pucker determination.</span>
<span class="sd">        :param mol_fem: (Mol) Class Mol containing the .xvg file for your free energy surface.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">def</span> <span class="nf">ring_pucker_determination</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">data</span>
            
            <span class="n">n</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">angles</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="o">-</span><span class="n">n</span><span class="p">:]</span>
            <span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">angles</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">180.0</span> <span class="o">-</span> <span class="n">angles</span><span class="p">,</span> <span class="o">-</span><span class="n">angles</span> <span class="o">-</span> <span class="mf">180.0</span><span class="p">)</span>

            <span class="n">data</span><span class="p">[:,</span> <span class="o">-</span><span class="n">n</span><span class="p">:]</span> <span class="o">=</span> <span class="n">angles</span>
            <span class="n">traj_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]])</span>

            <span class="n">pucker_table</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;1C4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">35.26</span><span class="p">,</span> <span class="o">-</span><span class="mf">35.26</span><span class="p">,</span> <span class="o">-</span><span class="mf">35.26</span><span class="p">],</span> <span class="s1">&#39;4C1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">35.26</span><span class="p">,</span> <span class="mf">35.26</span><span class="p">,</span> <span class="mf">35.26</span><span class="p">],</span>
                <span class="s1">&#39;1,4B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">35.26</span><span class="p">,</span> <span class="mf">74.20</span><span class="p">,</span> <span class="o">-</span><span class="mf">35.26</span><span class="p">],</span> <span class="s1">&#39;B1,4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">35.26</span><span class="p">,</span> <span class="o">-</span><span class="mf">74.20</span><span class="p">,</span> <span class="mf">35.26</span><span class="p">],</span>
                <span class="s1">&#39;2,5B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">74.20</span><span class="p">,</span> <span class="o">-</span><span class="mf">35.26</span><span class="p">,</span> <span class="o">-</span><span class="mf">35.26</span><span class="p">],</span> <span class="s1">&#39;B2,5&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">74.20</span><span class="p">,</span> <span class="mf">35.26</span><span class="p">,</span> <span class="mf">35.26</span><span class="p">],</span>
                <span class="s1">&#39;3,6B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">35.26</span><span class="p">,</span> <span class="o">-</span><span class="mf">35.26</span><span class="p">,</span> <span class="mf">74.20</span><span class="p">],</span> <span class="s1">&#39;B3,6&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">35.26</span><span class="p">,</span> <span class="mf">35.26</span><span class="p">,</span> <span class="o">-</span><span class="mf">74.20</span><span class="p">],</span>
                <span class="s1">&#39;1H2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">42.16</span><span class="p">,</span> <span class="mf">9.07</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.83</span><span class="p">],</span> <span class="s1">&#39;2H1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">42.16</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.07</span><span class="p">,</span> <span class="mf">17.83</span><span class="p">],</span>
                <span class="s1">&#39;2H3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">42.16</span><span class="p">,</span> <span class="mf">17.83</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.06</span><span class="p">],</span> <span class="s1">&#39;3H2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">42.16</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.83</span><span class="p">,</span> <span class="mf">9.06</span><span class="p">],</span>
                <span class="s1">&#39;3H4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">17.83</span><span class="p">,</span> <span class="o">-</span><span class="mf">42.16</span><span class="p">,</span> <span class="mf">9.07</span><span class="p">],</span> <span class="s1">&#39;4H3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">17.83</span><span class="p">,</span> <span class="mf">42.16</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.07</span><span class="p">],</span>
                <span class="s1">&#39;4H5&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">9.07</span><span class="p">,</span> <span class="mf">42.16</span><span class="p">,</span> <span class="mf">17.83</span><span class="p">],</span> <span class="s1">&#39;5H4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">9.07</span><span class="p">,</span> <span class="o">-</span><span class="mf">42.16</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.83</span><span class="p">],</span>
                <span class="s1">&#39;5H6&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">9.07</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.83</span><span class="p">,</span> <span class="o">-</span><span class="mf">42.16</span><span class="p">],</span> <span class="s1">&#39;6H5&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">9.07</span><span class="p">,</span> <span class="mf">17.83</span><span class="p">,</span> <span class="mf">42.16</span><span class="p">],</span>
                <span class="s1">&#39;6H1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">17.83</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.07</span><span class="p">,</span> <span class="mf">42.16</span><span class="p">],</span> <span class="s1">&#39;1H6&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">17.83</span><span class="p">,</span> <span class="mf">9.07</span><span class="p">,</span> <span class="o">-</span><span class="mf">42.16</span><span class="p">],</span>
                <span class="s1">&#39;1S3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">50.84</span><span class="p">,</span> <span class="o">-</span><span class="mf">50.84</span><span class="p">],</span> <span class="s1">&#39;3S1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">50.84</span><span class="p">,</span> <span class="mf">50.84</span><span class="p">],</span>
                <span class="s1">&#39;5S1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">50.84</span><span class="p">,</span> <span class="o">-</span><span class="mf">50.84</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">],</span> <span class="s1">&#39;1S5&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">50.84</span><span class="p">,</span> <span class="mf">50.84</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">],</span>
                <span class="s1">&#39;6S2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">50.84</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">50.84</span><span class="p">],</span> <span class="s1">&#39;2S6&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">50.84</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">50.84</span><span class="p">],</span>
                <span class="s1">&#39;1E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">35.26</span><span class="p">,</span> <span class="mf">17.37</span><span class="p">,</span> <span class="o">-</span><span class="mf">35.26</span><span class="p">],</span> <span class="s1">&#39;E1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">35.26</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.37</span><span class="p">,</span> <span class="mf">35.26</span><span class="p">],</span>
                <span class="s1">&#39;2E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">46.86</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">],</span> <span class="s1">&#39;E2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">46.86</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">],</span>
                <span class="s1">&#39;3E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">35.26</span><span class="p">,</span> <span class="o">-</span><span class="mf">35.26</span><span class="p">,</span> <span class="mf">17.37</span><span class="p">],</span> <span class="s1">&#39;E3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">35.26</span><span class="p">,</span> <span class="mf">35.26</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.37</span><span class="p">],</span>
                <span class="s1">&#39;4E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">46.86</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">],</span> <span class="s1">&#39;E4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">46.86</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">],</span>
                <span class="s1">&#39;5E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">17.37</span><span class="p">,</span> <span class="o">-</span><span class="mf">35.26</span><span class="p">,</span> <span class="o">-</span><span class="mf">35.26</span><span class="p">],</span> <span class="s1">&#39;E5&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">17.37</span><span class="p">,</span> <span class="mf">35.26</span><span class="p">,</span> <span class="mf">35.26</span><span class="p">],</span>
                <span class="s1">&#39;6E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mf">46.86</span><span class="p">],</span> <span class="s1">&#39;E6&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">,</span> <span class="o">-</span><span class="mf">46.86</span><span class="p">]</span>
            <span class="p">}</span>

            <span class="n">pucker_table_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">pucker_table</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="n">pucker_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pucker_table</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">len_puck</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pucker_keys</span><span class="p">)</span>
            <span class="n">pucker</span> <span class="o">=</span> <span class="p">[]</span> 

            <span class="c1"># RMSD calculations</span>
            <span class="k">for</span> <span class="n">ring</span> <span class="ow">in</span> <span class="n">angles</span><span class="p">:</span> 

                <span class="n">dist_matrix</span>  <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">pucker_table_list</span><span class="p">)</span>
                <span class="n">dist_matrix</span> <span class="o">-=</span> <span class="n">ring</span>
                <span class="n">l1_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">len_puck</span><span class="p">,))</span> <span class="p">;</span> <span class="n">l2_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">len_puck</span><span class="p">,))</span>

                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">len_puck</span><span class="p">):</span>
                    <span class="n">l1_norm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.333</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dist_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">dist_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dist_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
                    <span class="n">l2_norm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.333</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dist_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dist_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dist_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="c1">#print(l1_norm)</span>
                <span class="n">min_dist_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">l1_norm</span><span class="p">)</span>
                <span class="n">min_dist_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">l1_norm</span><span class="p">)</span>
                <span class="n">pucker</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pucker_keys</span><span class="p">[</span><span class="n">min_dist_indices</span><span class="p">])</span>

            <span class="c1"># Let us store this information as an attribute:</span>
            <span class="c1"># np.array(list(zip(traj_idx, pucker)))</span>

            <span class="k">return</span> <span class="n">pucker</span>

        <span class="k">def</span> <span class="nf">load_dihedrals</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">data</span>

            <span class="n">phi</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="p">::</span><span class="mi">2</span><span class="p">][:,</span> <span class="mi">1</span><span class="p">:]</span> <span class="c1"># Even col</span>
            <span class="n">psi</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># Odd col</span>

            <span class="k">return</span> <span class="n">phi</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">psi</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">puck_to_id</span><span class="p">(</span><span class="n">pucker</span><span class="p">):</span>

            <span class="n">pucker_table</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;1C4&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;4C1&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;1,4B&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;B1,4&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;2,5B&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;B2,5&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>  <span class="s1">&#39;3,6B&#39;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;B3,6&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
                <span class="s1">&#39;1H2&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;2H1&#39;</span><span class="p">:</span>  <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;2H3&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;3H2&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;3H4&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;4H3&#39;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span> <span class="s1">&#39;4H5&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;5H4&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
                <span class="s1">&#39;5H6&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> <span class="s1">&#39;6H5&#39;</span><span class="p">:</span> <span class="mi">17</span><span class="p">,</span><span class="s1">&#39;6H1&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span> <span class="s1">&#39;1H6&#39;</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span> <span class="s1">&#39;1S3&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;3S1&#39;</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span> <span class="s1">&#39;5S1&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;1S5&#39;</span><span class="p">:</span> <span class="mi">23</span><span class="p">,</span>
                <span class="s1">&#39;6S2&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;2S6&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;1E&#39;</span><span class="p">:</span> <span class="mi">26</span><span class="p">,</span> <span class="s1">&#39;E1&#39;</span><span class="p">:</span> <span class="mi">27</span><span class="p">,</span>  <span class="s1">&#39;2E&#39;</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span> <span class="s1">&#39;E2&#39;</span><span class="p">:</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39;3E&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;E3&#39;</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span>
                <span class="s1">&#39;4E&#39;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span> <span class="s1">&#39;E4&#39;</span><span class="p">:</span> <span class="mi">33</span><span class="p">,</span> <span class="s1">&#39;5E&#39;</span><span class="p">:</span> <span class="mi">34</span><span class="p">,</span> <span class="s1">&#39;E5&#39;</span><span class="p">:</span> <span class="mi">35</span><span class="p">,</span> <span class="s1">&#39;6E&#39;</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span> <span class="s1">&#39;E6&#39;</span><span class="p">:</span> <span class="mi">37</span> 
            <span class="p">}</span>
            <span class="k">return</span> <span class="n">pucker_table</span><span class="p">[</span><span class="n">pucker</span><span class="p">]</span>

        <span class="k">def</span> <span class="nf">id_to_puck</span><span class="p">(</span><span class="n">_id</span><span class="p">):</span> 

            <span class="n">pucker_table</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1C4&#39;</span><span class="p">,</span> <span class="s1">&#39;4C1&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;1,4B&#39;</span><span class="p">,</span> <span class="s1">&#39;B1,4&#39;</span><span class="p">,</span> <span class="s1">&#39;2,5B&#39;</span><span class="p">,</span> <span class="s1">&#39;B2,5&#39;</span><span class="p">,</span><span class="s1">&#39;3,6B&#39;</span><span class="p">,</span> <span class="s1">&#39;B3,6&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;1H2&#39;</span><span class="p">,</span> <span class="s1">&#39;2H1&#39;</span><span class="p">,</span> <span class="s1">&#39;2H3&#39;</span><span class="p">,</span> <span class="s1">&#39;3H2&#39;</span><span class="p">,</span> <span class="s1">&#39;3H4&#39;</span><span class="p">,</span> <span class="s1">&#39;4H3&#39;</span><span class="p">,</span> <span class="s1">&#39;4H5&#39;</span><span class="p">,</span> <span class="s1">&#39;5H4&#39;</span><span class="p">,</span> <span class="s1">&#39;5H6&#39;</span><span class="p">,</span> <span class="s1">&#39;6H5&#39;</span><span class="p">,</span><span class="s1">&#39;6H1&#39;</span><span class="p">,</span> <span class="s1">&#39;1H6&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;1S3&#39;</span><span class="p">,</span> <span class="s1">&#39;3S1&#39;</span><span class="p">,</span> <span class="s1">&#39;5S1&#39;</span><span class="p">,</span> <span class="s1">&#39;1S5&#39;</span><span class="p">,</span> <span class="s1">&#39;6S2&#39;</span><span class="p">,</span> <span class="s1">&#39;2S6&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;1E&#39;</span><span class="p">,</span> <span class="s1">&#39;E1&#39;</span><span class="p">,</span> <span class="s1">&#39;2E&#39;</span><span class="p">,</span> <span class="s1">&#39;E2&#39;</span><span class="p">,</span> <span class="s1">&#39;3E&#39;</span><span class="p">,</span> <span class="s1">&#39;E3&#39;</span><span class="p">,</span> <span class="s1">&#39;4E&#39;</span><span class="p">,</span> <span class="s1">&#39;E4&#39;</span><span class="p">,</span> <span class="s1">&#39;5E&#39;</span><span class="p">,</span> <span class="s1">&#39;E5&#39;</span><span class="p">,</span> <span class="s1">&#39;6E&#39;</span><span class="p">,</span> <span class="s1">&#39;E6&#39;</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">pucker_table</span><span class="p">[</span><span class="n">_id</span><span class="p">]</span>

        <span class="n">pucker</span> <span class="o">=</span> <span class="n">ring_pucker_determination</span><span class="p">(</span><span class="n">mol_pucker</span><span class="p">)</span>
        <span class="n">puck</span> <span class="o">=</span> <span class="p">[</span><span class="n">puck_to_id</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pucker</span><span class="p">]</span>
        <span class="n">puckers_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">38</span><span class="p">,))</span>
        
        <span class="n">phi</span><span class="p">,</span> <span class="n">psi</span>  <span class="o">=</span> <span class="n">load_dihedrals</span><span class="p">(</span><span class="n">mol_fem</span><span class="p">)</span>
        
        <span class="n">limit</span> <span class="o">=</span> <span class="mi">16</span>
        <span class="n">puck1</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">puck2</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># See id_to_puck for definitions</span>
        <span class="n">Temp</span> <span class="o">=</span> <span class="mf">300.0</span> <span class="p">;</span> <span class="n">R</span> <span class="o">=</span> <span class="mf">8.314</span> <span class="c1"># J/K mol</span>

        <span class="n">Hall</span><span class="p">,</span> <span class="n">x_edge</span><span class="p">,</span> <span class="n">y_edge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram2d</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">72</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mf">180.0</span><span class="p">],[</span><span class="o">-</span><span class="mf">180.0</span><span class="p">,</span> <span class="mf">180.0</span><span class="p">]])</span>
        <span class="c1">#hmax = max(full_data[:,:])</span>

        <span class="n">Hall</span> <span class="o">=</span> <span class="o">-</span> <span class="n">R</span> <span class="o">*</span> <span class="n">Temp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Hall</span><span class="p">)</span>
        <span class="n">hmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">Hall</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">hmin</span><span class="p">)</span>

        <span class="n">Hpuck</span><span class="p">,</span> <span class="n">edges</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogramdd</span><span class="p">((</span><span class="n">phi</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">puck</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">72</span><span class="p">,</span><span class="mi">72</span><span class="p">,</span><span class="mi">38</span><span class="p">],</span> <span class="nb">range</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mf">180.0</span><span class="p">,</span> <span class="mf">180.0</span><span class="p">],[</span><span class="o">-</span><span class="mf">180.0</span><span class="p">,</span> <span class="mf">180.0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">38</span><span class="p">]])</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">38</span><span class="p">):</span>
            <span class="n">puckers_sum</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Hpuck</span><span class="p">[:,:,</span><span class="n">i</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">38</span><span class="p">):</span> 
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:4s}{1:10g}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">id_to_puck</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">puckers_sum</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

        <span class="n">Hpuck</span> <span class="o">=</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span> <span class="n">Temp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Hpuck</span><span class="p">)</span>


        <span class="n">MHall</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_greater</span><span class="p">(</span><span class="mf">0.001</span><span class="o">*</span><span class="p">(</span><span class="n">Hall</span><span class="o">.</span><span class="n">T</span><span class="o">-</span><span class="n">hmin</span><span class="p">),</span> <span class="n">limit</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">MHpuck1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_greater</span><span class="p">(</span><span class="mf">0.001</span><span class="o">*</span><span class="p">(</span><span class="n">Hpuck</span><span class="p">[:,:,</span><span class="n">puck1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="o">-</span><span class="n">hmin</span><span class="p">),</span> <span class="n">limit</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">Hpuck</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">puck2</span><span class="p">]</span> <span class="o">=</span> <span class="n">hmin</span> <span class="c1">#To get colorbar right</span>
        <span class="n">MHpuck2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_greater</span><span class="p">(</span><span class="mf">0.001</span><span class="o">*</span><span class="p">(</span><span class="n">Hpuck</span><span class="p">[:,:,</span><span class="n">puck2</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="o">-</span><span class="n">hmin</span><span class="p">),</span> <span class="n">limit</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1">#Mat = [MHall, MHpuck1]</span>
        <span class="n">Mat</span> <span class="o">=</span> <span class="p">[</span><span class="n">MHall</span><span class="p">,</span> <span class="n">MHpuck1</span><span class="p">,</span> <span class="n">MHpuck2</span><span class="p">]</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">Mat</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">Mat</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Mat</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">4</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">colors</span>
        <span class="n">colors</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="p">):</span>

          <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">limit</span> <span class="c1">#np.amax(Mat[n])</span>
          <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>
          <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>

          <span class="n">xmin</span><span class="o">=-</span><span class="mf">180.0</span><span class="p">;</span> <span class="n">xmax</span><span class="o">=</span><span class="mf">180.0</span> 
          <span class="n">xticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
          <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
          <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{0:d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xticks</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span> <span class="c1">#rotation=45, ha=&quot;right&quot;, rotation_mode=&quot;anchor&quot;)</span>
          <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\phi$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

          <span class="n">ymin</span><span class="o">=-</span><span class="mf">180.0</span><span class="p">;</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">180.0</span> 
          <span class="n">yticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ymax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
          <span class="n">yticks</span> <span class="o">=</span> <span class="n">yticks</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
          <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
          <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{0:d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">yticks</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span> <span class="c1">#rotation=45, ha=&quot;right&quot;, rotation_mode=&quot;anchor&quot;)</span>

          <span class="k">if</span> <span class="n">n</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>  <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\psi$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

          <span class="n">cmap</span> <span class="o">=</span> <span class="n">ListedColormap</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
          <span class="c1">#plot = ax.imshow(Mat[n],  aspect=&#39;auto&#39;, interpolation=&#39;none&#39;, cmap=color_bar[n], vmin=vmin, vmax=vmax)</span>
          <span class="n">plot</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">Mat</span><span class="p">[</span><span class="n">n</span><span class="p">],</span>  <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
          <span class="n">plot</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">limit</span><span class="p">)</span>
          <span class="n">cb_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span>  <span class="nb">int</span><span class="p">(</span><span class="n">limit</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
          <span class="c1">#f n == len(Mat)-1: </span>
          <span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">ticks</span><span class="o">=</span><span class="n">cb_ticks</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
          <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span> <span class="s2">&quot;</span><span class="si">{0:3.1f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cb_ticks</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">fig</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span></div>

        
<div class="viewcode-block" id="Plot.rdf">
<a class="viewcode-back" href="../../MM_Util.html#MM_Util.plot.Plot.rdf">[docs]</a>
    <span class="k">def</span> <span class="nf">rdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mol</span><span class="p">):</span>
    
        <span class="n">data</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">data</span>
        <span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span>

        <span class="n">blues</span>  <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#deebf7&#39;</span><span class="p">,</span><span class="s1">&#39;#9ecae1&#39;</span><span class="p">,</span><span class="s1">&#39;#3182bd&#39;</span><span class="p">]</span>
        <span class="n">reds</span>   <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#fee0d2&#39;</span><span class="p">,</span><span class="s1">&#39;#fc9272&#39;</span><span class="p">,</span><span class="s1">&#39;#de2d26&#39;</span><span class="p">]</span>
        <span class="n">greens</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#e5f5e0&#39;</span><span class="p">,</span><span class="s1">&#39;#a1d99b&#39;</span><span class="p">,</span><span class="s1">&#39;#31a354&#39;</span><span class="p">]</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

        <span class="n">xmin</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">10</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span> <span class="p">;</span> <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span> <span class="p">;</span> <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">NullFormatter</span><span class="p">())</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span>

        <span class="n">xticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="nb">int</span><span class="p">((</span><span class="n">xmax</span><span class="o">-</span><span class="n">xmin</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xticks</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>

        <span class="c1">#TYR</span>
        <span class="n">div</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">3</span><span class="p">])</span> 
        <span class="k">if</span> <span class="n">div</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">div</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>  <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span><span class="o">/</span><span class="n">div</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">greens</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>  <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span><span class="o">/</span><span class="n">div</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">greens</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1">#D or E</span>
        <span class="n">div</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span> 
        <span class="k">if</span> <span class="n">div</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">div</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>  <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span><span class="o">/</span><span class="n">div</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">blues</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>  <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span><span class="o">/</span><span class="n">div</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">blues</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1">#HIS</span>
        <span class="n">div</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span> 
        <span class="k">if</span> <span class="n">div</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">div</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>  <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span><span class="o">/</span><span class="n">div</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">reds</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>  <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span><span class="o">/</span><span class="n">div</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">reds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        
        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">fig</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span></div>

        
<div class="viewcode-block" id="Plot.contour">
<a class="viewcode-back" href="../../MM_Util.html#MM_Util.plot.Plot.contour">[docs]</a>
    <span class="k">def</span> <span class="nf">contour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xpm_mol1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xpm_mol2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xpm_mol3</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">limit</span> <span class="o">=</span> <span class="mi">16</span>

        <span class="k">if</span> <span class="n">xpm_mol1</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">xpm_mol2</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">xpm_mol3</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span> 
            <span class="n">M1</span> <span class="o">=</span> <span class="n">xpm_mol1</span><span class="o">.</span><span class="n">data</span>
            <span class="n">M2</span> <span class="o">=</span> <span class="n">xpm_mol2</span><span class="o">.</span><span class="n">data</span>
            <span class="n">M3</span> <span class="o">=</span> <span class="n">xpm_mol3</span><span class="o">.</span><span class="n">data</span>
            <span class="n">MM1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_greater</span><span class="p">(</span><span class="n">M1</span><span class="p">,</span> <span class="n">limit</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">MM2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_greater</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span> <span class="n">limit</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> 
            <span class="n">MM3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_greater</span><span class="p">(</span><span class="n">M3</span><span class="p">,</span> <span class="n">limit</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> 
            <span class="n">Mat</span> <span class="o">=</span> <span class="p">[</span><span class="n">MM1</span><span class="p">,</span> <span class="n">MM2</span><span class="p">,</span> <span class="n">MM3</span><span class="p">]</span>

        <span class="k">elif</span> <span class="n">xpm_mol1</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">xpm_mol2</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">M1</span> <span class="o">=</span> <span class="n">xpm_mol1</span><span class="o">.</span><span class="n">data</span>
            <span class="n">M2</span> <span class="o">=</span> <span class="n">xpm_mol2</span><span class="o">.</span><span class="n">data</span>
             <span class="c1">#DiffM = M1-M2</span>
            <span class="n">MM1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_greater</span><span class="p">(</span><span class="n">M1</span><span class="p">,</span> <span class="n">limit</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">MM2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_greater</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span> <span class="n">limit</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  
            <span class="n">Mat</span> <span class="o">=</span> <span class="p">[</span><span class="n">MM1</span><span class="p">,</span> <span class="n">MM2</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Give me a correct number of some chunky matrices&quot;</span><span class="p">)</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">Mat</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">Mat</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">color_bar</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Blues_r&#39;</span><span class="p">,</span> <span class="s1">&#39;Blues_r&#39;</span><span class="p">,</span> <span class="s1">&#39;Blues_r&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;rainbow&#39;</span><span class="p">,</span> <span class="s1">&#39;rainbow&#39;</span><span class="p">,</span> <span class="s1">&#39;Blues_r&#39;</span><span class="p">,</span> <span class="s1">&#39;Blues_r&#39;</span><span class="p">,</span> <span class="s1">&#39;Blues_r&#39;</span><span class="p">]</span>


        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="p">):</span>

          <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">limit</span> <span class="c1">#np.amax(Mat[n])</span>
          <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>
          <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>

          <span class="n">xmin</span><span class="o">=-</span><span class="mf">180.0</span><span class="p">;</span> <span class="n">xmax</span><span class="o">=</span><span class="mf">180.0</span> 
          <span class="n">xticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
          <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
          <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{0:d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xticks</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span> <span class="c1">#rotation=45, ha=&quot;right&quot;, rotation_mode=&quot;anchor&quot;)</span>
          <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\phi$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

          <span class="n">ymin</span><span class="o">=-</span><span class="mf">180.0</span><span class="p">;</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">180.0</span> 
          <span class="n">yticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ymax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
          <span class="n">yticks</span> <span class="o">=</span> <span class="n">yticks</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
          <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
          <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{0:d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">yticks</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span> <span class="c1">#rotation=45, ha=&quot;right&quot;, rotation_mode=&quot;anchor&quot;)</span>

          <span class="k">if</span> <span class="n">n</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>  <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\psi$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

          <span class="n">plot</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">Mat</span><span class="p">[</span><span class="n">n</span><span class="p">],</span>  <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">color_bar</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
          <span class="n">plot</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">limit</span><span class="p">)</span>
          <span class="n">cb_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span>  <span class="nb">int</span><span class="p">(</span><span class="n">limit</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
          <span class="c1">#f n == len(Mat)-1: </span>
          <span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">ticks</span><span class="o">=</span><span class="n">cb_ticks</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
          <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span> <span class="s2">&quot;</span><span class="si">{0:3.1f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cb_ticks</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="c1"># plt.savefig(&#39;Dih_Cont.pdf&#39;, dpi=300)</span>
        <span class="c1"># plt.savefig(&#39;Dih_Cont.png&#39;, dpi=300)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">fig</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span></div>


<div class="viewcode-block" id="Plot.scatter">
<a class="viewcode-back" href="../../MM_Util.html#MM_Util.plot.Plot.scatter">[docs]</a>
    <span class="k">def</span> <span class="nf">scatter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a scatter plot from data</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
        <span class="n">xtick</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xtick</span>
        <span class="n">ytick</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ytick</span>
        <span class="n">xrange</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xrange</span>
        <span class="n">yrange</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yrange</span>

        <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span>
        <span class="n">desc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">desc</span>

        <span class="n">colors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">colors</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">]</span>

        <span class="n">data_x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">data_ys</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;Scatter Plot&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>


        <span class="k">if</span> <span class="n">xtick</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xtick</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ytick</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">ytick</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xrange</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xrange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_extend</span>
            <span class="n">xrange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_extend</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xrange</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">yrange</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">yrange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_extend</span>
            <span class="n">yrange</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_extend</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">yrange</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">labelleft</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;bottom&#39;</span><span class="p">]:</span> <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">);</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">FormatStrFormatter</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.0f</span><span class="s1">&#39;</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">FormatStrFormatter</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1">&#39;</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])):</span>

            <span class="n">data_y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="n">col</span><span class="p">]</span>
            <span class="n">data_ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_y</span><span class="p">)</span>

            <span class="n">fit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">data_x</span><span class="p">,</span> <span class="n">data_y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">data_x</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data_x</span><span class="p">,</span> <span class="n">data_y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">desc</span><span class="p">[</span><span class="n">col</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">col</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">xrange</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span> <span class="k">if</span> <span class="n">xrange</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">xrange</span>
        <span class="n">yrange</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span> <span class="k">if</span> <span class="n">yrange</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">yrange</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">fig</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Eugene Chung, Ryan Kwok, Murat Yaman, Hillel Lerner, Mateusz Marianski.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>